[فارسی](README-FA.md) 
[ENGLISH](README.md)
# CFW-BOT
ربات مدیریت ورکر کلادفلر! بدون نیاز به سرور، به راحتی می‌تونید هر تعداد کانفیگ vless-ws-tls بسازید، با چند کلیک از داخل ربات، این قطعه کد پایتون در phytonanywhere یا هر سرویس دیگه‌ای که از کد پایتون میزبانی کنه میشه اجرا کرد.
یه میانبر کوچک برای **دسترسی به اینترنت آزاد 🤍✨** 

![CFW1](https://github.com/NiREvil/CFW-BOT/assets/126243832/feeac4a2-ba8e-401b-b959-b02f1f1b4aaa)

## آموزش کامل در یوتیوب: 
[![YouTube Video](https://img.youtube.com/vi/ejgTbf_yJJQ/0.jpg)](https://www.youtube.com/watch?v=ejgTbf_yJJQ)


> بهتره ویدئو قبلی که کامل هست مشاهده بشه، در صورت داشتن مشکل هنگام ساخت یا اجرای ربات داخل موبایل مشاهده این آموزش نیز خالی از لطف نیست، لطفا دانلود نکنید و از یوتیوب ببینید چون بنده خدا برای رکورد ویدئوها کلی زحمت کشیده.
 
آموزش تکمیلی با موبایل:  [![YouTube Video](https://img.youtube.com/vi/xSRcZjAQeR4/1.jpg)](https://www.youtube.com/watch?v=xSRcZjAQeR4)

## فهرست مطالب
- [این چیه؟](#این-چیه؟)
  - [ویژگی‌ها](#ویژگی‌ها)
  - [پیش‌نیازها](#پیش‌نیازها)
  - [نصب آسان](#نصب-آسان)
  - [نصب عادی](#نصب-عادی)
  - [نجوه استفاده از ربات](#نحوه-استفاده-از-ربات)
  - [آپدیت ربات به نسخه آخر](#آپدیت-ربات-به-نسخه-آخر)
  - [پیدا کردن آسان proxyIP](#پیدا-کردن-آسان-ProxyIP)
  - [آموزش ایجاد بک اند مخزن آی‌پی تمیز کلادفلر](#آموزش-ایجاد-بک-اند-مخزن-آی‌پی-تمیز-کلادفلر)
- [نکته](#نکته)
- [آخرین نکته](#آخرین-نکته)


# این چیه؟
این ربات تلگرام پایتون با استفاده از ورکر کلادفلر ساخت کانفیگهای  Xray را آسان می کند! نیازی به راه‌اندازی‌های پیچیده سرور نیست، فقط این مراحل ساده را دنبال کنید تا شروع کنید:

## در ورژن 0.0.2 چه چیزهایی اضافه شد ؟ 
- لینک اشتراک برای هر کاربر
- پشتیبانی لینکهای اشتراک از IP_API که میتوانید تنها با قرار دادن آی پیهای جدید در لحظه اشتراک را به روز رسانی کنید
- حل مشکل ساپورت نکردن سایتهای پشت کلودفلر ( البته همچنان از آی پی سالم استفاده کنید که توسط کلودفلر فلگ نشده باشد )
- قابلبیت تغییر لینک API از داخل خود ربات
- حل مشکل نصب نشدن پیش نیازها بر روی PythonAnyWhere
  ## در ورژن 0.04 چه چیزهایی اضافه شده؟
  - اضافه شدن لینک اشتراک سینگ باکس
  - دکمه انتقال به صفحه ورکر
  - دکمه انتقال جهت تعویض ساب دامین
  - بارگذاری مجدد ورکرها با پروکسی جدید
  - اضافه شدن صفحه ویکی در بات برای حل مشکلات شما
  - حل برخی از باگها
## ویژگی‌ها
- **راه‌اندازی آسان**: بدون نیاز به هیچ سروری قابل اجرا بر روی محیطهای رایگان پایتون مانند PythonAnyWhere. 
- **پایگاه داده**: از SQLite برای مدیریت پایگاه داده استفاده میکند، به این صورت همیشه به لیست کاربران و لینکهای آنها در خود ربات دسترسی دارید . 
- **مدیریت کاربر**: ایجاد و مدیریت چندین کاربر به آسانی. هر کاربر به پیوندهای تولید شده خود در هر زمان دسترسی دارد.
- **راه‌اندازی بهینه**: با استفاده از Wrangler میتونید با سرعت کاربران خود را بسازید و آن را بر روی کلادفلر اجرا کنید

 ## پیش‌نیازها
- یک دامنه ثبت‌شده در کلادفلر
> بدون دامنه هم ممکنه، با دامنه ی خود وورکر (workers.dev) ولی عملکردش قرار نیست عالی باشه
- دسترسی به حساب کلادفلر
- توکن ربات تلگرام (دریافت از `BotFather` تلگرام)
- توکن API کلادفلر `API Tokens`
- آی دی بخش وورکرز اکانت کلادفلر `Account id`
- آی دی عددی اکانت تلگرامی که می‌خواهید از ربات بر روی اون اکانتتون استفاده کنید (ربات فقط برای اکانت ارائه شده کار خواهد کرد)

## نصب آسان 
در صورت بروز خطا و اجرا نشدن از پروسه نصب عادی پیروی کنید.
```bash
bash -c "$(curl -fsSL https://raw.githubusercontent.com/NiREvil/CFW-BOT/main/install.sh)"
```


## نصب عادی
1. یک حساب رایگان در [PythonAnywhere](https://www.pythonanywhere.com) بسازید.
2. توکن‌های مورد نیاز رو بدست بیارین و همه رو یکجا یادداشت کنید لازمشون داریم.
   - توکن ربات تلگرامی ایجاد شده توسط ربات [BotFather](https://t.me/BotFather)
   - توکن API کلادفلر از داشبورد کلادفلر (تو قسمت سرچ داخل کلادفلر تایپ کنید `api tokens`. میتونید از الگوی پیشفرض `Edit Cloudflare Workers` استفاده کنید و فقط به اون دسترسی `EDIT` رو در همه بخش‌ها بدید)
   - آی‌دی عددی اکانت تلگرامتون رو می‌تونید از طریق این بات به دست بیارید: [@useridinfobot](https://t.me/useridinfobot) و یا هر بات مشابه دیگه‌ای که می‌شناسید
- آی‌دی اکانت کلادفلر را می‌تونید از سمت راست صفحه وورکرز در کلادفلر پیدا کنید
4. در وبسایت [PythonAnywhere](https://www.pythonanywhere.com) در صفحه داشبورد؛ تب فایل‌ها را انتخاب کرده و بر روی `Open Bash Consol here` کلیک کنید.
5. حالا که توکن های مورد نیاز رو آماده کردید، می‌تونیم بریم برای اجرای کد و رباتمون. در مرحله اول پروژه را کلون کنید با دستور:
```bash
git clone https://github.com/NiREvil/CFW-BOT.git
```
6. به فولدر پروژه برید:
```bash
cd CFW-BOT
```
7. دسترسی لازم برای اجرا شدن فایل  requirement.sh رو به اون بدید:
```bash
chmod +x requirement.sh
```
8. و فایل را فراخوانی کنید:
```bash
./requirement.sh
```

 "اگر به مشکلاتی در اجرای requirement.sh در PythonAnywhere همچنین برخورد کردید، کنسول را با `close` ببندید و وارد منوی Files شده و فایل requirement.sh را باز کنید سپس با `ctrl+s` آن را ذخیره کرده و ببیندید و مجدد آن را اجرا کنید. این بار به خطایی برخورد نمیکنید ."
   اگر همچنان مشکل ادامه داشت تنها کافی است فایل `requirement.sh` را با dos2unix کانورت کنید از آنجایی که سایت PythonAnyWhere از این ابزار پشتیبانی نمیکند میتونید برای اینکار از `dos2unix.py` که در پوشه پروژه قرار دارد استفاده کنید و سپس مجدد فایل `requirement.sh` را اجرا کنید.
```bash
python3 dos2unix.py
```
 
9. فایل پایتون `install.py` را اجرا کنید، این فایل با پرسیدن مقادیر API و یوزر آیدی تنظیمات لازم را برای اجرای بات به صورت خودکار انجام میدهد:
```bash
python3 install.py
```
 10. در نهایت با این دستور بات را اجرا کنید:
 ```bash
 python3 cfw.py
 ```
## نکته:
اگر بعد دوهفته یکماه یه موقع دیدید که ربات کار نمی‌کنه و به درخواست‌های شما هیچ پاسخی نمیده قطعا بخاطر سایت pythonanywhere هستش، لازمه که برید توی سایت و bash console رو باز کنید، فقط دقت کنید اگر صفحه کنسول خالی بود نیاز نیست تمام دستورات رو از ابتدا اجرا کنید نه اصلا، از قبل کلون شدن فایل‌ها، پیش نیازها نصب شدن و آماده ان، فقط کافیه که با دستور:
```bash
cd CFW-BOT
```
وارد دایرکتوری شده و سپس
با ارسال این دستور چک می‌کنه اگر آپدیت‌ جدیدی وجود داشت اون‌‌ها رو از مخزن گیت‌هاب کپی و اعمال میکنه روی دستگاه:
```bash
git pull
```

و در نهایت با این دستور بات رو اجرا کنید.
```bash
python3 cfw.py
```

## آپدیت بات به نسخه آخر
> **مورد مصرف:** موقع از کار افتادن کنسول پایتون یا نیاز به آپدیت کردن کد ربات به نسخه آخر از تک دستور زیر استفاده میکنیم:

با این دستور وارد فولدر ربات شده و مخزن گیت‌هاب پروژه رو چک کرده در صورت مشاهده تغییرات در هرکدام از فایل‌ها؛ آن ها را در سورس دستگاه اعمال کرده و در نهایت بات را اجرا میکند.
```bash
cd CFW-BOT && git pull && python3 cfw.py
```

## نحوه استفاده از ربات
وقتی ربات در حالت اجراست، فقط کافیست یک کاربر جدید در تلگرام بسازید.
برای ساخت کاربر جدید و تنظیم ساب دامنه نیازی به تنظیم کردن ساب دامنه از قبل ندارید، به صورت خودکار هر مقداری از ساب دامنه که اجرا کنید وارد میشود. ولی حتما باید دامنه آن از قبل در کلادفلر ست شده باشد.
مانند هر ورکر دیگری برای اتصال نیاز به پروکسی کلادفلر دارد ، که میتواند آی پی یا وب سایتی باشد که پشت کلادفلر است.

## پیدا کردن آی‌پی یا دامنه کلادفلر
شما از هر روشی که بلد هستید میتونید استفاده کنید (آموزش های بیشتر در رابطه پیدا کردن با آی‌پی تمییز به بخش بعدی برید، دو پاراگراف پایین تر [ایجاد بک اند](https://github.com/NiREvil/CFW-BOT/blob/main/CFW_Worker_Sub.md)).

## پیدا کردن آسان proxyIP
برای بدست آوردن آسان و سریع پروکسی‌آی‌پی مخصوص داخل وورکر پیشنهاد میکنم به این آموزش مراجعه کنید. [ده ها پروکسی آی‌پی جدید در کمتر از 60 ثانیه](https://github.com/NiREvil/vless/blob/main/sub/ProxyIP.md)


## آموزش ایجاد بک اند مخزن آی‌پی تمیز کلادفلر
آموزش ایجاد مخزن آی‌پی تمیز کلادفلرو و بک اند برای لینک ساب ربات رو هم یاد بگیرید چون مخزن پیشفرض در معرض دید عموم قرار داده و فیلترچی میتونه کارش رو یکسره کنه، ده دقیقه ای برای خودتون رو بسازید حرفه ای پر گودرتتت  🤪
[ساخت بک اند برای لینک ساب ربات CFW](https://github.com/NiREvil/CFW-BOT/blob/main/CFW_Worker_Sub.md)

## آخرین نکته
بعضی وقتا ممکنه ربات هنگام ایجاد یوزر در مرحله worker deployment خطا نشون بده و بگه یوزر ساخته نشد و به گزارشات در کنسول سربزنید

این مشکل به چند دلیل میتونه رخ بده
• اگر برای نام کاربر در قسمت Add user و یا برای subdomain از کاراکتر های نامناسب استفاده بشه، در این صورت برای wrangler غیرقابل تشخیص خواهد بود و عملیات ساخت وورکر ناموفق میشه

• اگر ساب‌دامین انتخابی شما از قبل در DNS رکوردها وجود داشته باشه، عملیات ساخت ناموفق میشه

• اگر دامنه شما در حساب کلادفلر وجود نداشته باشه ساخت وورکر ناموفق میشه

•اگر از فرمت صحیح ساب‌دامین پیروی نکنید باز هم ناموفق می

••دقت کنید هم برای نام کاربر در مرحله add user و هم برای ساب دامین برای تمامی حروف از حروف کوچیک انگلیسی استفاده بشه، وگرنه در غیر این صورت مطابق عکس ناموفق میشه.


### Credits :
[2ri4eUI](https://github.com/2ri4eUI) & [cmliu](https://github.com/cmliu)

---
### stay in touch 
[![Telegram Badge](https://img.shields.io/badge/Telegram-Profile-informational?style=flat&logo=telegram&logoColor=white&color=1CA2F1)](https://t.me/F_NiREvil)
